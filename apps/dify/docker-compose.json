{
  "services": [
    {
      "name": "dify-db",
      "image": "postgres:15-alpine",
      "environment": {
        "POSTGRES_USER": "postgres",
        "POSTGRES_PASSWORD": "difyai123456",
        "POSTGRES_DB": "dify"
      },
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/dify/postgres",
          "containerPath": "/var/lib/postgresql/data",
          "readOnly": false
        }
      ]
    },
    {
      "name": "dify-redis",
      "image": "redis:6-alpine",
      "environment": {
        "REDIS_PASSWORD": "difyai123456",
        "REDISCLI_AUTH": "difyai123456"
      },
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/dify/redis",
          "containerPath": "/data",
          "readOnly": false
        }
      ]
    },
    {
      "name": "dify-qdrant",
      "image": "langgenius/qdrant:v1.7.3",
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/dify/qdrant",
          "containerPath": "/qdrant/storage",
          "readOnly": false
        }
      ],
      "environment": {
        "QDRANT_API_KEY": "difyai123456"
      }
    },
    {
      "name": "dify-api",
      "image": "langgenius/dify-api:1.1.3",
      "environment": {
        "MODE": "api",
        "DB_TYPE": "postgres",
        "DB_HOST": "dify-db",
        "DB_PORT": "5432",
        "DB_NAME": "dify",
        "DB_USER": "postgres",
        "DB_PASSWORD": "difyai123456",
        "REDIS_HOST": "dify-redis",
        "REDIS_PASSWORD": "difyai123456",
        "VECTOR_STORE": "qdrant",
        "QDRANT_URL": "http://dify-qdrant:6333",
        "QDRANT_API_KEY": "difyai123456"
      },
      "dependsOn": {
        "dify-db": { "condition": "service_started" },
        "dify-redis": { "condition": "service_started" },
        "dify-qdrant": { "condition": "service_started" }
      }
    },
    {
      "name": "dify-worker",
      "image": "langgenius/dify-api:1.1.3",
      "environment": {
        "MODE": "worker",
        "DB_TYPE": "postgres",
        "DB_HOST": "dify-db",
        "DB_PORT": "5432",
        "DB_NAME": "dify",
        "DB_USER": "postgres",
        "DB_PASSWORD": "difyai123456",
        "REDIS_HOST": "dify-redis",
        "REDIS_PASSWORD": "difyai123456",
        "VECTOR_STORE": "qdrant",
        "QDRANT_URL": "http://dify-qdrant:6333",
        "QDRANT_API_KEY": "difyai123456"
      },
      "dependsOn": {
        "dify-db": { "condition": "service_started" },
        "dify-redis": { "condition": "service_started" },
        "dify-qdrant": { "condition": "service_started" }
      }
    },
    {
      "name": "dify-web",
      "image": "langgenius/dify-web:1.1.3",
      "environment": {
        "CONSOLE_API_URL": "",
        "APP_API_URL": "",
        "NEXT_TELEMETRY_DISABLED": "0"
      }
    },
    {
      "name": "dify-nginx",
      "image": "nginx:latest",
      "internalPort": 80,
      "isMain": true,
      "dependsOn": {
        "dify-api": { "condition": "service_started" },
        "dify-web": { "condition": "service_started" }
      },
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/dify/nginx.conf",
          "containerPath": "/etc/nginx/nginx.conf",
          "readOnly": false
        }
      ]
    }
  ]
}

